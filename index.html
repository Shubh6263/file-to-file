<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Tools Suite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas2image@1.0.5/canvas2image.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --gray: #adb5bd;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
        }
        
        header h1 {
            color: var(--secondary);
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        header p {
            color: var(--dark);
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .tool-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        
        .tool-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        
        .tool-icon {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            color: white;
            font-size: 2.5rem;
        }
        
        .tool-content {
            padding: 20px;
        }
        
        .tool-content h3 {
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .tool-content p {
            color: var(--dark);
            line-height: 1.5;
        }
        
        .tool-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            max-width: 700px;
            margin: 40px auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            animation: modalAppear 0.4s ease;
        }
        
        @keyframes modalAppear {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            padding: 20px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            font-size: 1.8rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }
        
        .close-modal:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .input-section {
            margin-bottom: 25px;
        }
        
        .input-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .file-input {
            width: 100%;
            padding: 12px;
            border: 2px dashed var(--gray);
            border-radius: 8px;
            background: #f8f9fa;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .file-input:hover {
            border-color: var(--accent);
        }
        
        .text-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .preview-area {
            margin: 25px 0;
            text-align: center;
        }
        
        .preview-area img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary);
        }
        
        .btn-secondary {
            background: #e9ecef;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #dee2e6;
        }
        
        .result-area {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            background: #f8f9fa;
            display: none;
        }
        
        .result-area textarea {
            width: 100%;
            height: 150px;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-family: monospace;
            resize: vertical;
        }
        
        .download-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: var(--success);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .download-link:hover {
            background: #3aa8d0;
        }
        
        .file-info {
            margin-top: 15px;
            padding: 15px;
            background: #e9f5ff;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            color: var(--dark);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Frontend Tools Suite</h1>
            <p>All-in-one toolkit for file conversions, encoding, and formatting - completely client-side with no server processing</p>
        </header>
        
        <div class="tools-grid">
            <!-- Image to PDF -->
            <div class="tool-card" data-tool="image-to-pdf">
                <div class="tool-icon">
                    <i>üìÑ</i>
                </div>
                <div class="tool-content">
                    <h3>Image to PDF</h3>
                    <p>Convert image files to a single PDF document</p>
                </div>
            </div>
            
            <!-- File Size Checker -->
            <div class="tool-card" data-tool="file-size">
                <div class="tool-icon">
                    <i>üìè</i>
                </div>
                <div class="tool-content">
                    <h3>File Size Checker</h3>
                    <p>Check the size of your files</p>
                </div>
            </div>
            
            <!-- Image Compressor -->
            <div class="tool-card" data-tool="compress-image">
                <div class="tool-icon">
                    <i>üóúÔ∏è</i>
                </div>
                <div class="tool-content">
                    <h3>Compress Image</h3>
                    <p>Reduce the file size of an image</p>
                </div>
            </div>
            
            <!-- Image Rotator -->
            <div class="tool-card" data-tool="rotate-image">
                <div class="tool-icon">
                    <i>üîÑ</i>
                </div>
                <div class="tool-content">
                    <h3>Rotate Image</h3>
                    <p>Rotate an image left or right</p>
                </div>
            </div>
            
            <!-- Grayscale Filter -->
            <div class="tool-card" data-tool="grayscale">
                <div class="tool-icon">
                    <i>‚ö´</i>
                </div>
                <div class="tool-content">
                    <h3>Grayscale Filter</h3>
                    <p>Apply a grayscale filter to an image</p>
                </div>
            </div>
            
            <!-- PNG to JPG -->
            <div class="tool-card" data-tool="png-to-jpg">
                <div class="tool-icon">
                    <i>üñºÔ∏è</i>
                </div>
                <div class="tool-content">
                    <h3>PNG to JPG</h3>
                    <p>Convert PNG images to JPG format</p>
                </div>
            </div>
            
            <!-- URL Encoder -->
            <div class="tool-card" data-tool="url-encoder">
                <div class="tool-icon">
                    <i>üîó</i>
                </div>
                <div class="tool-content">
                    <h3>URL Encoder</h3>
                    <p>Encode a URL by replacing special characters</p>
                </div>
            </div>
            
            <!-- JSON Formatter -->
            <div class="tool-card" data-tool="json-formatter">
                <div class="tool-icon">
                    <i>{} </i>
                </div>
                <div class="tool-content">
                    <h3>JSON Formatter</h3>
                    <p>Format and beautify JSON data</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals for each tool -->
    <div id="image-to-pdf-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Image to PDF Converter</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="pdf-images">Select images to convert:</label>
                    <div class="file-input" id="pdf-images">Click to select images or drag them here</div>
                    <input type="file" id="pdf-files" multiple accept="image/*" style="display: none;">
                </div>
                
                <div class="preview-area" id="pdf-preview">
                    <p>No images selected</p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="create-pdf">Create PDF</button>
                    <button class="btn btn-secondary close-modal">Cancel</button>
                </div>
                
                <div class="result-area" id="pdf-result">
                    <p>PDF created successfully!</p>
                    <a href="#" class="download-link" id="download-pdf">Download PDF</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="file-size-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>File Size Checker</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="size-files">Select files to check:</label>
                    <div class="file-input" id="size-input">Click to select files or drag them here</div>
                    <input type="file" id="size-files" multiple style="display: none;">
                </div>
                
                <div class="result-area" id="size-result">
                    <div class="file-info">
                        <p>File Name: <span id="file-name"></span></p>
                        <p>File Size: <span id="file-size"></span></p>
                        <p>File Type: <span id="file-type"></span></p>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-secondary close-modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="compress-image-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Compress Image</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="compress-file">Select an image to compress:</label>
                    <div class="file-input" id="compress-input">Click to select an image or drag it here</div>
                    <input type="file" id="compress-file" accept="image/*" style="display: none;">
                </div>
                
                <div class="input-section">
                    <label for="quality-range">Compression Quality: <span id="quality-value">80</span>%</label>
                    <input type="range" id="quality-range" min="10" max="100" value="80">
                </div>
                
                <div class="preview-area" id="compress-preview">
                    <p>No image selected</p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="compress-btn">Compress Image</button>
                    <button class="btn btn-secondary close-modal">Cancel</button>
                </div>
                
                <div class="result-area" id="compress-result">
                    <div class="file-info">
                        <p>Original Size: <span id="original-size"></span></p>
                        <p>Compressed Size: <span id="compressed-size"></span></p>
                        <p>Size Reduction: <span id="size-reduction"></span></p>
                    </div>
                    <a href="#" class="download-link" id="download-compressed">Download Compressed Image</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="rotate-image-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Rotate Image</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="rotate-file">Select an image to rotate:</label>
                    <div class="file-input" id="rotate-input">Click to select an image or drag it here</div>
                    <input type="file" id="rotate-file" accept="image/*" style="display: none;">
                </div>
                
                <div class="preview-area" id="rotate-preview">
                    <p>No image selected</p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-secondary" id="rotate-left">Rotate Left</button>
                    <button class="btn btn-secondary" id="rotate-right">Rotate Right</button>
                    <button class="btn btn-primary" id="save-rotated">Save Image</button>
                </div>
                
                <div class="result-area" id="rotate-result">
                    <a href="#" class="download-link" id="download-rotated">Download Rotated Image</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="grayscale-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Grayscale Filter</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="grayscale-file">Select an image to convert to grayscale:</label>
                    <div class="file-input" id="grayscale-input">Click to select an image or drag it here</div>
                    <input type="file" id="grayscale-file" accept="image/*" style="display: none;">
                </div>
                
                <div class="preview-area" id="grayscale-preview">
                    <p>No image selected</p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="apply-grayscale">Apply Grayscale</button>
                    <button class="btn btn-secondary close-modal">Cancel</button>
                </div>
                
                <div class="result-area" id="grayscale-result">
                    <a href="#" class="download-link" id="download-grayscale">Download Grayscale Image</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="png-to-jpg-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>PNG to JPG Converter</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="png-file">Select PNG image to convert:</label>
                    <div class="file-input" id="png-input">Click to select a PNG image or drag it here</div>
                    <input type="file" id="png-file" accept="image/png" style="display: none;">
                </div>
                
                <div class="preview-area" id="png-preview">
                    <p>No image selected</p>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="convert-png">Convert to JPG</button>
                    <button class="btn btn-secondary close-modal">Cancel</button>
                </div>
                
                <div class="result-area" id="png-result">
                    <a href="#" class="download-link" id="download-jpg">Download JPG Image</a>
                </div>
            </div>
        </div>
    </div>
    
    <div id="url-encoder-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>URL Encoder</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="url-input">Enter URL to encode:</label>
                    <input type="text" class="text-input" id="url-input" placeholder="https://example.com/page?name=value">
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="encode-url">Encode URL</button>
                    <button class="btn btn-secondary" id="decode-url">Decode URL</button>
                </div>
                
                <div class="result-area" id="url-result">
                    <label for="encoded-url">Result:</label>
                    <textarea id="encoded-url" readonly></textarea>
                </div>
            </div>
        </div>
    </div>
    
    <div id="json-formatter-modal" class="tool-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>JSON Formatter</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-section">
                    <label for="json-input">Enter JSON to format:</label>
                    <textarea class="text-input" id="json-input" rows="8" placeholder='{"key": "value", "array": [1, 2, 3]}'></textarea>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="format-json">Format JSON</button>
                    <button class="btn btn-secondary" id="minify-json">Minify JSON</button>
                </div>
                
                <div class="result-area" id="json-result">
                    <label for="formatted-json">Formatted JSON:</label>
                    <textarea id="formatted-json" readonly></textarea>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Frontend Tools Suite - All processing happens in your browser. No files are uploaded to any server.</p>
            <p>¬© 2025 Frontend Tools Suite | Privacy focused client-side processing</p>
        </div>
    </footer>
    
    <script>
        // Tool selection and modal handling
        document.querySelectorAll('.tool-card').forEach(card => {
            card.addEventListener('click', () => {
                const toolName = card.getAttribute('data-tool');
                document.getElementById(`${toolName}-modal`).style.display = 'block';
            });
        });
        
        // Close modal buttons
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tool-modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            });
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            document.querySelectorAll('.tool-modal').forEach(modal => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
        
        // File input handling
        document.querySelectorAll('.file-input').forEach(input => {
            input.addEventListener('click', () => {
                const fileInputId = input.id.replace('input', 'file').replace('-input', '-file');
                document.getElementById(fileInputId).click();
            });
            
            input.addEventListener('dragover', (e) => {
                e.preventDefault();
                input.style.borderColor = '#4361ee';
                input.style.backgroundColor = '#e9ecef';
            });
            
            input.addEventListener('dragleave', () => {
                input.style.borderColor = '#adb5bd';
                input.style.backgroundColor = '#f8f9fa';
            });
            
            input.addEventListener('drop', (e) => {
                e.preventDefault();
                input.style.borderColor = '#adb5bd';
                input.style.backgroundColor = '#f8f9fa';
                
                const fileInputId = input.id.replace('input', 'file').replace('-input', '-file');
                const fileInput = document.getElementById(fileInputId);
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileSelect(e.dataTransfer.files, fileInputId);
                }
            });
        });
        
        // Handle file selection
        function handleFileSelect(files, inputId) {
            const toolId = inputId.replace('-file', '');
            const previewArea = document.getElementById(`${toolId}-preview`);
            
            if (files.length === 0) {
                previewArea.innerHTML = '<p>No file selected</p>';
                return;
            }
            
            const file = files[0];
            
            // Update file input text
            const fileInput = document.getElementById(`${toolId}-input`);
            if (fileInput) {
                fileInput.textContent = file.name;
            }
            
            // Show preview if it's an image
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewArea.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                
                reader.readAsDataURL(file);
            } else {
                previewArea.innerHTML = `<p>Selected file: ${file.name}</p>`;
            }
            
            // For file size tool
            if (toolId === 'size') {
                const resultArea = document.getElementById('size-result');
                resultArea.style.display = 'block';
                
                document.getElementById('file-name').textContent = file.name;
                document.getElementById('file-size').textContent = formatFileSize(file.size);
                document.getElementById('file-type').textContent = file.type || 'Unknown';
            }
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Image to PDF
        document.getElementById('pdf-files').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'pdf-files');
        });
        
        document.getElementById('create-pdf').addEventListener('click', function() {
            const files = document.getElementById('pdf-files').files;
            if (files.length === 0) {
                alert('Please select at least one image');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            const resultArea = document.getElementById('pdf-result');
            
            let processed = 0;
            
            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = new Image();
                    img.src = e.target.result;
                    
                    img.onload = function() {
                        if (i > 0) pdf.addPage();
                        
                        const width = img.width;
                        const height = img.height;
                        const ratio = width / height;
                        
                        // Calculate dimensions to fit in PDF page (A4: 210x297mm)
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = pdf.internal.pageSize.getHeight();
                        
                        let imgWidth = pdfWidth;
                        let imgHeight = pdfHeight;
                        
                        if (ratio > pdfWidth / pdfHeight) {
                            imgHeight = pdfWidth / ratio;
                        } else {
                            imgWidth = pdfHeight * ratio;
                        }
                        
                        const x = (pdfWidth - imgWidth) / 2;
                        const y = (pdfHeight - imgHeight) / 2;
                        
                        pdf.addImage(img, 'JPEG', x, y, imgWidth, imgHeight);
                        
                        processed++;
                        
                        if (processed === files.length) {
                            const pdfBlob = pdf.output('blob');
                            const url = URL.createObjectURL(pdfBlob);
                            
                            document.getElementById('download-pdf').href = url;
                            document.getElementById('download-pdf').download = 'converted-images.pdf';
                            
                            resultArea.style.display = 'block';
                        }
                    };
                };
                
                reader.readAsDataURL(files[i]);
            }
        });
        
        // File Size Checker
        document.getElementById('size-files').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'size-files');
        });
        
        // Image Compression
        document.getElementById('compress-file').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'compress-file');
        });
        
        document.getElementById('quality-range').addEventListener('input', function() {
            document.getElementById('quality-value').textContent = this.value;
        });
        
        document.getElementById('compress-btn').addEventListener('click', function() {
            const fileInput = document.getElementById('compress-file');
            if (fileInput.files.length === 0) {
                alert('Please select an image');
                return;
            }
            
            const file = fileInput.files[0];
            const quality = parseInt(document.getElementById('quality-range').value) / 100;
            const resultArea = document.getElementById('compress-result');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    
                    // Convert to JPG for compression
                    const compressedDataURL = canvas.toDataURL('image/jpeg', quality);
                    
                    // Calculate sizes
                    const originalSize = file.size;
                    const compressedSize = Math.round((compressedDataURL.length * 3) / 4); // Approximate
                    const reduction = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);
                    
                    // Update result area
                    document.getElementById('original-size').textContent = formatFileSize(originalSize);
                    document.getElementById('compressed-size').textContent = formatFileSize(compressedSize);
                    document.getElementById('size-reduction').textContent = `${reduction}%`;
                    
                    // Update download link
                    const downloadLink = document.getElementById('download-compressed');
                    downloadLink.href = compressedDataURL;
                    downloadLink.download = `compressed-${file.name.replace(/\.[^/.]+$/, "")}.jpg`;
                    
                    // Show result
                    resultArea.style.display = 'block';
                };
            };
            
            reader.readAsDataURL(file);
        });
        
        // Rotate Image
        let currentRotation = 0;
        let rotatedImage = null;
        
        document.getElementById('rotate-file').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'rotate-file');
            currentRotation = 0;
            rotatedImage = null;
        });
        
        document.getElementById('rotate-left').addEventListener('click', function() {
            rotateImage(-90);
        });
        
        document.getElementById('rotate-right').addEventListener('click', function() {
            rotateImage(90);
        });
        
        function rotateImage(degrees) {
            const fileInput = document.getElementById('rotate-file');
            if (fileInput.files.length === 0) {
                alert('Please select an image');
                return;
            }
            
            const file = fileInput.files[0];
            const previewArea = document.getElementById('rotate-preview');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Update rotation
                    currentRotation += degrees;
                    if (currentRotation >= 360) currentRotation -= 360;
                    if (currentRotation < 0) currentRotation += 360;
                    
                    // Adjust canvas size based on rotation
                    if (currentRotation % 180 === 0) {
                        canvas.width = img.width;
                        canvas.height = img.height;
                    } else {
                        canvas.width = img.height;
                        canvas.height = img.width;
                    }
                    
                    // Translate to center and rotate
                    ctx.translate(canvas.width / 2, canvas.height / 2);
                    ctx.rotate(currentRotation * Math.PI / 180);
                    ctx.drawImage(img, -img.width / 2, -img.height / 2);
                    
                    // Reset transformation
                    ctx.setTransform(1, 0, 0, 1, 0, 0);
                    
                    // Update preview
                    previewArea.innerHTML = `<img src="${canvas.toDataURL()}" alt="Rotated Preview">`;
                    
                    // Save rotated image for download
                    rotatedImage = canvas.toDataURL();
                };
            };
            
            reader.readAsDataURL(file);
        }
        
        document.getElementById('save-rotated').addEventListener('click', function() {
            if (!rotatedImage) {
                alert('Please rotate an image first');
                return;
            }
            
            const resultArea = document.getElementById('rotate-result');
            const downloadLink = document.getElementById('download-rotated');
            
            const fileInput = document.getElementById('rotate-file');
            const file = fileInput.files[0];
            
            downloadLink.href = rotatedImage;
            downloadLink.download = `rotated-${file.name}`;
            resultArea.style.display = 'block';
        });
        
        // Grayscale Filter
        document.getElementById('grayscale-file').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'grayscale-file');
        });
        
        document.getElementById('apply-grayscale').addEventListener('click', function() {
            const fileInput = document.getElementById('grayscale-file');
            if (fileInput.files.length === 0) {
                alert('Please select an image');
                return;
            }
            
            const file = fileInput.files[0];
            const previewArea = document.getElementById('grayscale-preview');
            const resultArea = document.getElementById('grayscale-result');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    
                    // Apply grayscale filter
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    
                    for (let i = 0; i < data.length; i += 4) {
                        const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                        data[i] = avg;     // red
                        data[i + 1] = avg; // green
                        data[i + 2] = avg; // blue
                    }
                    
                    ctx.putImageData(imageData, 0, 0);
                    
                    // Update preview
                    previewArea.innerHTML = `<img src="${canvas.toDataURL()}" alt="Grayscale Preview">`;
                    
                    // Update download link
                    const downloadLink = document.getElementById('download-grayscale');
                    downloadLink.href = canvas.toDataURL();
                    downloadLink.download = `grayscale-${file.name}`;
                    
                    // Show result
                    resultArea.style.display = 'block';
                };
            };
            
            reader.readAsDataURL(file);
        });
        
        // PNG to JPG
        document.getElementById('png-file').addEventListener('change', function(e) {
            handleFileSelect(e.target.files, 'png-file');
        });
        
        document.getElementById('convert-png').addEventListener('click', function() {
            const fileInput = document.getElementById('png-file');
            if (fileInput.files.length === 0) {
                alert('Please select a PNG image');
                return;
            }
            
            const file = fileInput.files[0];
            if (file.type !== 'image/png') {
                alert('Please select a PNG image');
                return;
            }
            
            const previewArea = document.getElementById('png-preview');
            const resultArea = document.getElementById('png-result');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.src = e.target.result;
                
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    const ctx = canvas.getContext('2d');
                    
                    // Fill background with white (since JPG doesn't support transparency)
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Draw the PNG image
                    ctx.drawImage(img, 0, 0);
                    
                    // Convert to JPG
                    const jpgData = canvas.toDataURL('image/jpeg', 0.9);
                    
                    // Update preview
                    previewArea.innerHTML = `<img src="${jpgData}" alt="JPG Preview">`;
                    
                    // Update download link
                    const downloadLink = document.getElementById('download-jpg');
                    downloadLink.href = jpgData;
                    downloadLink.download = file.name.replace('.png', '.jpg');
                    
                    // Show result
                    resultArea.style.display = 'block';
                };
            };
            
            reader.readAsDataURL(file);
        });
        
        // URL Encoder
        document.getElementById('encode-url').addEventListener('click', function() {
            const input = document.getElementById('url-input').value;
            if (!input) {
                alert('Please enter a URL');
                return;
            }
            
            const encoded = encodeURIComponent(input);
            document.getElementById('encoded-url').value = encoded;
            document.getElementById('url-result').style.display = 'block';
        });
        
        document.getElementById('decode-url').addEventListener('click', function() {
            const input = document.getElementById('url-input').value;
            if (!input) {
                alert('Please enter a URL');
                return;
            }
            
            try {
                const decoded = decodeURIComponent(input);
                document.getElementById('encoded-url').value = decoded;
                document.getElementById('url-result').style.display = 'block';
            } catch (e) {
                alert('Invalid URL encoding');
            }
        });
        
        // JSON Formatter
        document.getElementById('format-json').addEventListener('click', function() {
            const input = document.getElementById('json-input').value;
            if (!input) {
                alert('Please enter JSON');
                return;
            }
            
            try {
                const parsed = JSON.parse(input);
                const formatted = JSON.stringify(parsed, null, 4);
                document.getElementById('formatted-json').value = formatted;
                document.getElementById('json-result').style.display = 'block';
            } catch (e) {
                alert('Invalid JSON: ' + e.message);
            }
        });
        
        document.getElementById('minify-json').addEventListener('click', function() {
            const input = document.getElementById('json-input').value;
            if (!input) {
                alert('Please enter JSON');
                return;
            }
            
            try {
                const parsed = JSON.parse(input);
                const minified = JSON.stringify(parsed);
                document.getElementById('formatted-json').value = minified;
                document.getElementById('json-result').style.display = 'block';
            } catch (e) {
                alert('Invalid JSON: ' + e.message);
            }
        });
    </script>
</body>
</html>
